import"./options.1bd2caf9.js";var e=globalThis,t={},n={},a=e.parcelRequire88c7;null==a&&((a=function(e){if(e in t)return t[e].exports;if(e in n){var a=n[e];delete n[e];var l={id:e,exports:{}};return t[e]=l,a.call(l.exports,l,l.exports),l.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){n[e]=t},e.parcelRequire88c7=a),a.register;var l=a("fXsES"),o=a("klb57"),i=a("3tltx"),d=a("bi7XK");let r={};async function s(){await chrome.storage.sync.set({actionMap:r})}async function c(e,t){let n=await chrome.storage.sync.get("actionMap");void 0===n.actionMap?(r=e,chrome.storage.sync.set({actionMap:e})):r=n.actionMap,t()}let u=document.getElementById("webcam"),p=document.getElementById("gesture-area"),m=document.getElementById("gesture-output"),g=document.getElementById("video-wrapper"),v=document.getElementById("overlay-canvas"),f=v.getContext("2d"),y=document.getElementById("processing-canvas"),h=y.getContext("2d"),E=null,w=0,b=!0,L=null,x=null,k=chrome.runtime.connect({name:"options-page"});async function C(){let e=(await chrome.storage.sync.get(["mirrorEnabled"])).mirrorEnabled??!1;"none"!==p.style.display&&g.classList.toggle("mirror",e)}async function T(){if(x)return;await o.setBackend("webgl"),await o.ready();let e=i.SupportedModels.MediaPipeHands;x=await i.createDetector(e,{runtime:"tfjs",modelType:"full"})}async function M(){if(!E)try{p.style.display="block",m.textContent="Loading model...",await C(),await T(),m.textContent="",u.srcObject=E=await navigator.mediaDevices.getUserMedia({video:!0}),u.onloadedmetadata=()=>{v.width=u.videoWidth,v.height=u.videoHeight,y.width=u.videoWidth,y.height=u.videoHeight},await u.play(),N()}catch(e){console.error("Could not start camera on options page:",e),m.textContent=""}}function I(){p.style.display="none",E&&(cancelAnimationFrame(L),E.getTracks().forEach(e=>e.stop()),E=null,u.srcObject=null)}function S(e,t){if(f.clearRect(0,0,v.width,v.height),e){for(let t of(f.strokeStyle="rgba(255, 255, 255, 0.8)",f.lineWidth=2,[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[0,9],[9,10],[10,11],[11,12],[0,13],[13,14],[14,15],[15,16],[0,17],[17,18],[18,19],[19,20],[5,9],[9,13],[13,17],[0,5]])){let n=e[t[0]],a=e[t[1]];n&&a&&(f.beginPath(),f.moveTo(n.x,n.y),f.lineTo(a.x,a.y),f.stroke())}f.fillStyle="#00B6FF";for(let n=0;n<e.length;n++){let a=e[n],l=4+60*t[n].z;f.beginPath(),f.arc(a.x,a.y,Math.max(1,l),0,2*Math.PI),f.fill()}}}async function N(){if(!E?.active||!x)return;if(u.readyState<2)return void requestAnimationFrame(N);h.drawImage(u,0,0,y.width,y.height);let e=await (0,d.getFilteredHands)(x,y),t=performance.now();if(e.length>0){let n=e[0].keypoints;S(n,e[0].keypoints3D),t-w>17&&(w=t,chrome.runtime.sendMessage({type:"keypoints",keypoints:n}),b=!1)}else S(null),t-w>600&&!b&&(w=t,chrome.runtime.sendMessage({type:"keypoints",keypoints:null}),b=!0);L=requestAnimationFrame(N)}chrome.storage.onChanged.addListener(C),document.addEventListener("DOMContentLoaded",async()=>{await c(l.DEFAULT_ACTION_MAP,function e(){let t=document.getElementById("action-map-container");t.innerHTML="",Object.entries(r).forEach(([n,a])=>{t.append(function(t,n){let a=document.createElement("div");a.className="mapping-pill";let o=document.createElement("select");o.classList.add("dropdown-arrow"),l.GESTURES.forEach(e=>{let n=document.createElement("option");n.value=e,n.textContent=e,e===t&&(n.selected=!0),o.append(n)});let i=document.createElement("select");i.classList.add("dropdown-arrow"),l.ACTIONS.forEach(e=>{let t=document.createElement("option");t.value=e.id,t.textContent=e.name,e.id===n.id&&(t.selected=!0),i.append(t)});let d=document.createElement("span");d.className="value-container";let c=document.createElement("button");c.textContent="✕",c.className="remove-btn";let u=()=>{d.innerHTML="";let a=l.ACTIONS.find(e=>e.id===i.value);if(!a?.hasValue){r[t].value=null,s();return}let o=!a.predefinedValues||!a.predefinedValues.some(e=>e.value===n.value),c=document.createElement("input");if(c.type="text",c.className="value-input",c.placeholder=a.placeholder||"...",c.addEventListener("input",()=>{r[t].value=c.value,s()}),a.predefinedValues){c.classList.add("dropdown-arrow");let l=document.createElement("select");if(l.className="predefined-select",l.classList.add("dropdown-arrow"),a.predefinedValues.forEach(e=>{let t=document.createElement("option");t.value=e.value,t.textContent=e.name,l.append(t)}),a.customValueLabel){let e=document.createElement("option");e.value="custom",e.textContent=a.customValueLabel,l.append(e)}if(d.append(l),l.addEventListener("change",()=>{"custom"===l.value?(c.style.display="inline-block","openPage"==n.id?c.value="https://":c.value="",r[t].value=c.value,c.focus()):(c.classList.toggle("focus-outline",!1),c.style.display="none",r[t].value=l.value),s().then(e)}),o){let e=document.createElement("button");e.className="value-select-overlay",e.addEventListener("click",()=>{l.showPicker(),c.classList.toggle("focus-outline",!0)}),d.append(e)}}if(d.append(c),a.predefinedValues){let e=d.querySelector(".predefined-select");e&&(e.value=o?"custom":n.value)}c.style.display=o?"inline-block":"none",n.value&&(c.value=n.value)};return o.addEventListener("change",()=>{delete r[t],r[t=o.value]=n,s().then(e)}),i.addEventListener("change",()=>{n.id=i.value;let e=l.ACTIONS.find(e=>e.id===i.value);n.value=e.predefinedValues?e.predefinedValues[0].value:null,u(),s()}),c.addEventListener("click",()=>{delete r[t],a.remove(),s()}),a.append(o),a.append(document.createTextNode(" → ")),a.append(i),a.append(d),a.append(c),u(),a}(n,"string"==typeof a?{id:a,value:null}:a))}),document.getElementById("add-mapping").onclick=()=>{let t=new Set(Object.keys(r));r[l.GESTURES.find(e=>!t.has(e))||l.GESTURES[0]]={id:l.ACTIONS[0].id,value:null},s(),e()},document.getElementById("set-to-default").onclick=()=>{confirm("Are you sure you want to reset all mappings to their default settings?")&&(r=l.DEFAULT_ACTION_MAP,s(),e())}}),I()}),window.addEventListener("beforeunload",()=>{I()}),k.onMessage.addListener(e=>{switch(e.type){case"gesture-data":let{gesture:t}=e.data;m.textContent=`Detected Gesture: ${t||"None"}`;break;case"start-camera":M();break;case"stop-camera":I()}});
//# sourceMappingURL=options.b6051402.js.map
